<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="../css/main.css">
    <link rel="stylesheet" href="../css/mypage.css">
    <link rel='stylesheet' href='https://cdn-uicons.flaticon.com/3.0.0/uicons-regular-straight/css/uicons-regular-straight.css'>
    <link rel='stylesheet' href='https://cdn-uicons.flaticon.com/3.0.0/uicons-regular-rounded/css/uicons-regular-rounded.css'>

</head>
<body>
    <header>
        <h1>D.O.</h1>
    </header>
    <div id="layout">
        <nav>
            <div>
                <ul>
                    <a href="main.html" style="text-decoration: none; color: black;"><li><i class="fi fi-rs-home"></i>Ìôà</li></a>
                    <li id="this"><i class="fi fi-rr-book-bookmark"></i>ÎØ∏ÏÖò</li>
                    <li><i class="fi fi-rr-user"></i></i>ÎßàÏù¥ÌéòÏù¥ÏßÄ</li>
                </ul>
            </div>
            <div id="profile">
                <div>
                    <span>ÎåÄÏÜåÎßàÍ≥†</span>
                    <small>@daegusomago2025</small>
                </div>
                <button id="logout">Î°úÍ∑∏ÏïÑÏõÉ</button>
            </div>
        </nav>
        <main>
            <div class="content-wr">
                <div class="profile-content" style="position: relative;">
                    <img src="../image/profile-img.png" style="width: 50px; height: 50px; border-radius: 50%; float: left;">
                    <div style="width: 30%; height: 100%; display: flex; flex-direction: column; margin: 10px; margin-left: 60px;">
                        <h4 style="display: inline-block;">ÎåÄÏÜåÎßàÍ≥†</h4>
                        <p style="color: #A9A9A9; display: inline-block;">@daegusomago2025</p>    
                    </div>
                    <span style="font-size: 10px; bottom: 20px; right: 30px; position: absolute;">Î°úÍ∑∏ÏïÑÏõÉ</span>
                </div>

                <div class="main-wr" style="display: flex; gap: 30px; justify-content: space-between;">
                    <div class="main mainbox-left" style="width: 40%;">
                        <div class="mainbox-left_top br-20" style="padding: 8px; padding-left: 40px;">
                            <h3>ÏßÄÎÇú ÎØ∏ÏÖòÎ™©Î°ù</h3>
                        </div>
                        <div class="mainbox-left_bottom br-20" style="border: none;">
                            <div class="container mt-5">
                                <ul class="list">
                                <li class="tab-button">ÎßûÏ∂§ ÎØ∏ÏÖò</li>
                                <li class="tab-button orange">ÎßåÎì† ÎØ∏ÏÖò</li>
                                </ul>
                                <div class="tab-content-wr br-20" style="border-radius: 0 0 20px 20px ; border-top: 0px ;">
                                    <div class="tab-content">
                                    <p>test</p>
                                    </div>
                                    <div class="tab-content show">
                                    <p>test2</p>
                                    </div>
                                </div>
                            </div> 
                        </div>
                    </div>
                    <div class="main mainbox-right br-20">
                        <div class="mainbox-right-" style="height: 350px;">
                            <div class="title-box">
                                <h5>ÏßÑÌñâÏ§ëÏù∏ Î±ÉÏßÄ</h5>
                            </div>
                            <div style="width: 100%; height: 280px; display: flex; gap: 10px; justify-content: space-between; padding: 25px;">
                                
                                <div class="b-box">
                                    <div style="width: 80px; height: 80px; background-color: white;  margin: auto; margin-top: 20px; border-radius: 50%;">
                                        <img src="../image/2.png" class="c">

                                    </div>
                                    <h5 style="display: block;font-weight: bold; margin-top: 10px; text-align: center;" class="API-name">Ïù¥Î¶Ñ</h5>
                                    <div style="display: flex;">
                                        <div style="margin-top: 10px;height: 7px; position: relative; width: 80%; background-color: #FFC6C6; border-radius: 20px;">
                                            <div class="progress" ></div>                                       
                                        </div>
                                        <span style="font-size: 8px; color: #F46666; float: right; margin-top: 10px; margin-left: 2px;">90%</span>
                                    </div>
                                    <div>
                                        <p class="si">ÏÑ§Î™Ö</p>
                                    </div>
                                </div>
                                <div class="b-box">
                                    <div style="width: 80px; height: 80px; background-color: white;  margin: auto; margin-top: 20px; border-radius: 50%;">
                                        <img src="../image/4.png" class="c">

                                    </div>
                                    <h5 style="display: block;font-weight: bold; margin-top: 10px; text-align: center;" class="API-name">Ïù¥Î¶Ñ</h5>
                                    <div style="display: flex;">
                                        <div style="margin-top: 10px;height: 7px; position: relative; width: 80%; background-color: #FFC6C6; border-radius: 20px;">
                                            <div class="progress" ></div>                                       
                                        </div>
                                        <span style="font-size: 8px; color: #F46666; float: right; margin-top: 10px; margin-left: 2px;">90%</span>
                                    </div>
                                    <div>
                                        <p class="si">ÏÑ§Î™Ö</p>
                                    </div>
                                </div>
                                <div class="b-box">
                                    <div style="width: 80px; height: 80px; background-color: white;  margin: auto; margin-top: 20px; border-radius: 50%;">
                                        <img src="../image/5.png" class="c">

                                    </div>
                                    <h5 style="display: block;font-weight: bold; margin-top: 10px; text-align: center;" class="API-name">Ïù¥Î¶Ñ</h5>
                                    <div style="display: flex;">
                                        <div style="margin-top: 10px;height: 7px; position: relative; width: 80%; background-color: #FFC6C6; border-radius: 20px;">
                                            <div class="progress" ></div>                                       
                                        </div>
                                        <span style="font-size: 8px; color: #F46666; float: right; margin-top: 10px; margin-left: 2px;">90%</span>
                                    </div>
                                    <div>
                                        <p class="si">ÏÑ§Î™Ö</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="mainbox-right-" style="border-top: solid 1px #E6D0D0; height: 350px;">
                            <div class="title-box">
                                <h5>Ï¥ù Î±ÉÏßÄ</h5>
                            </div>
                            <div class="tkffuwnj">
                                <div class="seven-box">
                                      <div class="o-seven-box">
                                    <img src="../image/1.png" class="c2">
                                    <div style="width: 100%; height: 100%; background-color: rgba(0,0,0,0.3); border-radius: 50%; position: absolute; top:0px"></div>

                                </div>
                                    <h5 style="display: block;font-weight: bold; margin-top: 10px; text-align: center;" class="API-name">Ï≤´ ÎèÑÏ†ÑÏûê</h5>
                                </div>
                                <div class="seven-box">
                                    <div class="o-seven-box">
                                    <img src="../image/2.png" class="c2">
                                        <div style="width: 100%; height: 100%; background-color: rgba(0,0,0,0.3); border-radius: 50%; position: absolute; top:0px"></div>

                                    </div>
                                    <h5 style="display: block;font-weight: bold; margin-top: 10px; text-align: center;">Íæ∏Ï§ÄÌïú ÎèÑÏ†ÑÏûê</h5>
                                </div>
                                <div class="seven-box">
                                    <div class="o-seven-box">
                                    <img src="../image/4.png" class="c2">
                                        <div style="width: 100%; height: 100%; background-color: rgba(0,0,0,0.3); border-radius: 50%; position: absolute; top:0px"></div>

                                    </div>
                                    <h5 style="display: block;font-weight: bold; margin-top: 10px; text-align: center;">ÎèÑÏ†Ñ ÎßàÏä§ÌÑ∞</h5>
                                </div>
                                <div class="seven-box">
                                    <div class="o-seven-box">
                                    <img src="../image/5.png" class="c2">
                                        <div style="width: 100%; height: 100%; background-color: rgba(0,0,0,0.3); border-radius: 50%; position: absolute; top:0px"></div>

                                    </div>
                                    <h5 style="display: block;font-weight: bold; margin-top: 10px; text-align: center;">ÌïúÍ≥ÑÎ•º ÎÑòÏùÄ Ïûê</h5>

                                </div>
                                <div class="seven-box">
                                    <div class="o-seven-box">
                                    <img src="../image/7.png" class="c2">
                                        <div style="width: 100%; height: 100%; background-color: rgba(0,0,0,0.3); border-radius: 50%; position: absolute; top:0px"></div>

                                    </div>
                                    <h5 style="display: block;font-weight: bold; margin-top: 10px; text-align: center;">Ï±åÎ¶∞ÏßÄ Î¶¨Îçî</h5>

                                </div>
                                <div class="seven-box">
                                    <div class="o-seven-box">
                                        <div style="width: 100%; height: 100%; background-color: rgba(0,0,0,0.3); border-radius: 50%; top:0px; position: relative;"></div>
                                        <h4 class="h4-">??</h4>

                                    </div>
                                    <h5 style="display: block;font-weight: bold; margin-top: 10px; text-align: center;">ÎØ∏Îûò Í∞úÏ≤ôÏûê</h5>

                                </div>
                                <div class="seven-box">
                                    <div class="o-seven-box">

                                        <div style="width: 100%; height: 100%; background-color: rgba(0,0,0,0.3); border-radius: 50%; top:0px; position: relative;"></div>
                                        <h4 class="h4-">??</h4>

                                    </div>
                                    <h5 style="display: block;font-weight: bold; margin-top: 10px; text-align: center;">Î∂àÍµ¥Ïùò ÌÉêÌóòÍ∞Ä</h5>

                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>
    <script>

        document.addEventListener("DOMContentLoaded", () => {
        const token = "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJkb0BkZ3N3LmhzLmtyIiwiaWF0IjoxNzU0MTY3Nzg0LCJleHAiOjE3NTQyMDM3ODQsInN1YiI6IjEiLCJwdXJwb3NlIjoiYWNjZXNzIn0.v5aYwVQi7IaDuw1H49PXWj39Cc96bB2zkhJXb5gGtB4";
        const apiUrl = "http://10.10.6.55:8080/missions/completed";

        fetch(apiUrl, {
            method: "GET",
            headers: {
            Authorization: "Bearer " + token,
            },
        })
            .then((res) => {
            if (!res.ok) throw new Error("API Ìò∏Ï∂ú Ïã§Ìå®: " + res.status);
            return res.json();
            })
            .then((apiResponse) => {
            // Î∞õÏùÄ Îç∞Ïù¥ÌÑ∞ ÏµúÏã†Ïàú Ï†ïÎ†¨
            apiResponse.data.sort(
                (a, b) => new Date(b.grantedAt) - new Date(a.grantedAt)
            );

            const sevenBoxes = document.querySelectorAll(".seven-box");

            sevenBoxes.forEach((box, index) => {
                const data = apiResponse.data[index];
                if (!data) return;

                const h5 = box.querySelector("h5");
                if (!h5) return;

                h5.innerHTML = data.title;

                const overlay = box.querySelector(".o-seven-box > div");
                if (overlay && h5.innerHTML === data.title) {
                overlay.classList.add("none"); // Ïò§Î≤ÑÎ†àÏù¥ Ïà®ÍπÄ
                } else if (overlay) {
                overlay.classList.remove("none"); // Ïò§Î≤ÑÎ†àÏù¥ Î≥¥ÏûÑ
                }
            });
            })
            .catch((err) => {
            console.error("API Ìò∏Ï∂ú Ïã§Ìå®:", err);
            alert("Îç∞Ïù¥ÌÑ∞Î•º Î∂àÎü¨Ïò§Îäî Îç∞ Ïã§Ìå®ÌñàÏäµÎãàÎã§.");
            });
        });




        document.addEventListener("DOMContentLoaded", () => {
        const token = "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJkb0BkZ3N3LmhzLmtyIiwiaWF0IjoxNzU0MTY3Nzg0LCJleHAiOjE3NTQyMDM3ODQsInN1YiI6IjEiLCJwdXJwb3NlIjoiYWNjZXNzIn0.v5aYwVQi7IaDuw1H49PXWj39Cc96bB2zkhJXb5gGtB4"; // Ïã§Ï†ú ÌÜ†ÌÅ∞ ÎÑ£Í∏∞
        const apiUrl = 'http://10.10.6.55:8080/missions/completed';

        fetch(apiUrl, {
            method: 'GET',
            headers: {
            'Authorization': 'Bearer ' + token
            }
        })
        .then(res => {
            if (!res.ok) throw new Error("API Ìò∏Ï∂ú Ïã§Ìå®: " + res.status);
            return res.json();
        })
        .then(data => {
            // Ïòà: achievedÍ∞Ä trueÏù∏ Îç∞Ïù¥ÌÑ∞ ÌïÑÌÑ∞ÎßÅ, Ï†ïÎ†¨ ÌõÑ ÏÉÅÏúÑ 3Í∞ú Ï∂îÏ∂ú
            const top3 = data.data
            .filter(item => item.achieved)
            .sort((a, b) => b.progress - a.progress)
            .slice(0, 3);

            const boxes = document.querySelectorAll('.b-box');
            top3.forEach((item, i) => {
            if (boxes[i]) {
                boxes[i].querySelector('h5.API-name').textContent = item.title;
                boxes[i].querySelector('.progress').style.width = item.progress + '%';
                boxes[i].querySelector('span').textContent = item.progress + '%';
                boxes[i].querySelector('p.si').textContent = item.description;
            }
            });
        })
        .catch(err => {
            console.error("API Ìò∏Ï∂ú Ïã§Ìå®:", err);
            alert("Îç∞Ïù¥ÌÑ∞Î•º Î∂àÎü¨Ïò§Îäî Îç∞ Ïã§Ìå®ÌñàÏäµÎãàÎã§.");
        });
        });





        const token = "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJkb0BkZ3N3LmhzLmtyIiwiaWF0IjoxNzU0MTY3Nzg0LCJleHAiOjE3NTQyMDM3ODQsInN1YiI6IjEiLCJwdXJwb3NlIjoiYWNjZXNzIn0.v5aYwVQi7IaDuw1H49PXWj39Cc96bB2zkhJXb5gGtB4";

        fetch('http://10.10.6.55:8080/missions/completed', {
        method: 'GET',
        headers: {
            'Authorization': 'Bearer ' + token
        }
        })
        .then(response => {
        if (!response.ok) {
            throw new Error("ÏÑúÎ≤Ñ ÏùëÎãµ Ïò§Î•ò: " + response.status);
        }
        return response.json();
        })
        .then(data => {
        // ÏùëÎãµÏóêÏÑú statusÍ∞Ä "IN_PROGRESS"Ïù∏ Ìï≠Î™© ÌïÑÌÑ∞ÎßÅ
        const inProgress = data.data.filter(item => item.status === "IN_PROGRESS");

        // Í∑∏ Ï§ëÏóêÏÑú aiGenerated Í∞íÏúºÎ°ú Î∂ÑÎ¶¨
        const aiGeneratedMissions = inProgress.filter(item => item.aiGenerated);
        const userGeneratedMissions = inProgress.filter(item => !item.aiGenerated);

        // ÏΩòÏÜî Ï∂úÎ†•
        console.log("‚úÖ AIÍ∞Ä ÏÉùÏÑ±Ìïú ÏßÑÌñâ Ï§ë ÎØ∏ÏÖò:");
        console.table(aiGeneratedMissions);

        console.log("üßë ÏÇ¨Ïö©ÏûêÍ∞Ä ÏÉùÏÑ±Ìïú ÏßÑÌñâ Ï§ë ÎØ∏ÏÖò:");
        console.table(userGeneratedMissions);
        })
        .catch(error => {
        console.error("ÏóêÎü¨ Î∞úÏÉù:", error);
        });


        document.addEventListener("DOMContentLoaded", () => {
          const token = "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJkb0BkZ3N3LmhzLmtyIiwiaWF0IjoxNzU0MTY3Nzg0LCJleHAiOjE3NTQyMDM3ODQsInN1YiI6IjEiLCJwdXJwb3NlIjoiYWNjZXNzIn0.v5aYwVQi7IaDuw1H49PXWj39Cc96bB2zkhJXb5gGtB4";
        
          // ‚úÖ API Ìò∏Ï∂ú
          fetch("http://10.10.6.55:8080/missions/completed", {
            method: "GET",
            headers: {
              "Authorization": "Bearer " + token
            }
          })
            .then(response => {
              if (!response.ok) throw new Error("ÏÑúÎ≤Ñ ÏùëÎãµ Ïò§Î•ò");
              return response.json();
            })
            .then(data => {
              console.log("Î∞õÏùÄ Îç∞Ïù¥ÌÑ∞:", data);
              const missions = data.data;
              const tabContents = document.querySelectorAll(".tab-content");
        
              // ÌÉ≠ ÎÇ¥Ïö© Ï¥àÍ∏∞Ìôî
              tabContents.forEach(tc => tc.innerHTML = "");
        
              // Îç∞Ïù¥ÌÑ∞Î•º ÌÉ≠Ïóê ÎÇòÎà†ÏÑú ÏÇΩÏûÖ
              missions.forEach(mission => {
                const p = document.createElement("p");
                p.textContent = mission.content;
        
                // isPrivate false ‚Üí ÎßûÏ∂§ ÎØ∏ÏÖò (0Î≤à ÌÉ≠), true ‚Üí ÎßåÎì† ÎØ∏ÏÖò (1Î≤à ÌÉ≠)
                if (mission.isPrivate === false) {
                  tabContents[0]?.appendChild(p);
                } else {
                  tabContents[1]?.appendChild(p);
                }
              });
            })
            .catch(err => {
              console.error("API Ìò∏Ï∂ú Ïã§Ìå®:", err);
            });
        
          // ‚úÖ ÌÉ≠ Ï†ÑÌôò Ïù¥Î≤§Ìä∏ ÏÑ§Ï†ï
          const tabButtons = document.querySelectorAll('.tab-button');
          const tabContents = document.querySelectorAll('.tab-content');
        
          tabButtons.forEach((btn, index) => {
            btn.addEventListener('click', () => {
              // Î™®Îì† Î≤ÑÌäºÏóêÏÑú 'orange' Ï†úÍ±∞
              tabButtons.forEach(b => b.classList.remove('orange'));
        
              // ÌÅ¥Î¶≠Ìïú Î≤ÑÌäºÏóê 'orange' Ï∂îÍ∞Ä
              btn.classList.add('orange');
        
              // Î™®Îì† ÌÉ≠ÏóêÏÑú 'show' Ï†úÍ±∞
              tabContents.forEach(content => content.classList.remove('show'));
        
              // Ìï¥Îãπ ÌÉ≠ÏóêÎßå 'show' Ï∂îÍ∞Ä
              tabContents[index].classList.add('show');
            });
          });
        });
        </script>
        
</body>
</html>